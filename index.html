<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>:: API STAR WARS ::</title>
    <link
      rel="shortcut icon"
      href="./img/favSTARWARS.jpg"
      type="image/x-icon"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="row mt-3">
        <h3><i class="fa-solid fa-jedi"></i> STAR WARS API</h3>
        <p>Este frontend muestra datos de los personajes de Star Wars</p>
      </div>
      <form>
        <div class="row mt-3">
          <div class="col-md-4">
            <label for="nombrePersonaje" class="label-control"
              >Personaje:</label
            >
            <input
              type="text"
              name="nombrePersonaje"
              id="nombrePersonaje"
              class="form-control"
              placeholder="Escribe un personaje (ej: Luke, Vader, Yoda)"
            />
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-4">
            <button
              class="btn btn-sm btn-warning"
              type="button"
              onclick="buscarPersonaje()"
            >
              <i class="fa-solid fa-magnifying-glass"></i> Buscar
            </button>
          </div>
        </div>
      </form>
      <div class="row my-5">
        <div id="resultado">
          <!--se llena desde AJAX-->
        </div>
      </div>
    </div>

    <script>
      function buscarPersonaje() {
        const nombre = $("#nombrePersonaje").val().trim();

        if (!nombre) {
          $("#resultado").html(
            '<p style="color: red;">Por favor escribe el nombre de un personaje</p>',
          );
          return;
        }
        $("#resultado").html('<p class="loading">Buscando info...</p>');

        $.ajax({
          url: "https://akabab.github.io/starwars-api/api/all.json",
          method: "GET",
          success: function (data) {
            //buscamos en el array
            const personaje = data.find((item) =>
              item.name.toLowerCase().includes(nombre.toLowerCase()),
            );

            if (personaje) {
              $("#resultado").html(`
                            <div class="card">
                                <div class="card-body">
                                    <h2 class="card-title">${personaje.name}</h2>
                                    <div class="row">
                                        <div class="col-md-7">
                                            <p><strong>Planeta de Origen:</strong> ${personaje.homeworld || "Desconocido"}</p>
                                            <p><strong>Especie:</strong> ${personaje.species || "Humano"}</p>
                                            <p><strong>Altura:</strong> ${personaje.height}</p>
                                            <p><strong>Masa:</strong> ${personaje.mass}</p>
                                            <p><strong>Genero:</strong> ${personaje.gender}</p>
                                            <p><strong>Color de Ojos:</strong> ${personaje.eyeColor}</p>
                                            <p><strong>Color de Cabello:</strong> ${personaje.hairColor}</p>
                                        </div>
                                        <div class="col-md-5 text-center d-flex align-items-center justify-content-center">
                                            <img
                                                src="${personaje.image}"
                                                alt="${personaje.name}"
                                                class="img-fluid"
                                                style="max-width: 250px; border-radius: 20px; border:4px solid #ffc107; box-shadow: 0 8px 20px rgba(0,0,0,0.3);"
                                                onerror="this.src='https://placehold.co/300x400?text=Imagen+no+disponible'"
                                            >
                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                        `);
            } else {
              $("#resultado").html(
                `<p style="color:red">Personaje "${nombre}" no encontrado. <br>Prueba con: luke, vader, yoda, etc.</p>`,
              );
            }
          },
          error: function (error) {
            $("#resultado").html(
              '<p style="color:red">Error al conectar a la API</p>',
            );
            console.log("Error:", error);
          },
        });
      }
    </script>
  </body>
</html>
